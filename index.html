<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Upload de Imagem - Supabase</title>
    <!-- <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>

    <h2>Upload de Imagem para Supabase</h2>
    <form id="uploadForm">
        <label for="fileInput">Escolha uma imagem:</label>
        <input type="file" id="fileInput" accept="image/*" required>
        <br><br>
        <button type="submit">Fazer Upload</button>
    </form>

    <script>
        // Inicialize o cliente Supabase
        const SUPABASE_URL = 'https://junnzyyfvrscsprmtden.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp1bm56eXlmdnJzY3Nwcm10ZGVuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTAwMzY3NDgsImV4cCI6MjAyNTYxMjc0OH0.0klro7_-4-y5FimxzLkRFLvEA5Ssl4LxHoeBpDRj_IY';
        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        document.getElementById('uploadForm').addEventListener('submit', async function(event) {
            event.preventDefault();

            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];

            if (file) {
                const fileName = `${Date.now()}_${file.name}`; // Nome Ãºnico para o arquivo

                try {
                    const { data, error } = await supabaseClient
                        .storage
                        .from('imagens')
                        .upload(fileName, file);

                    if (error) {
                        console.error('Erro no upload:', error.message);
                        alert('Erro ao enviar a imagem.');
                    } else {
                        alert('Imagem enviada com sucesso!');
                        console.log('Dados do upload:', data);
                    }
                } catch (error) {
                    console.error('Erro:', error);
                    alert('Ocorreu um erro ao tentar enviar a imagem.');
                }
            } else {
                alert('Por favor, selecione uma imagem.');
            }
        });
    </script>

</body>
</html>

<!-- Criar a regra para permitir upload -->